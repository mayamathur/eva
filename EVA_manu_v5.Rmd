---
title: ''

header-includes:
- \usepackage[T1]{fontenc}
- \usepackage{microtype}
- \usepackage[margin=1in]{geometry}
- \usepackage{fancyhdr}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead{}
- \fancyfoot{}
- \fancyhead[C]{E-Value Analog for Regression}
- \fancyfoot[RO,LE]{\thepage}
- \usepackage{booktabs}
- \usepackage{lettrine}
- \usepackage{paralist}
- \usepackage{setspace}\singlespacing
- \usepackage{url}
- \usepackage{parskip}
- \usepackage{color,soul}
- \usepackage{palatino}
- \usepackage{amsmath, amsthm}
- \newtheorem{theorem}{Theorem}
- \newtheorem{corollary}{Corollary}
- \newtheorem{lemma}{Lemma}


output: pdf_document
citation_package: natbib
bibliography: refs_eva_2.bib
---

\section*{Main text}

\begin{enumerate}
\item{ Intro paragraph \begin{enumerate}
  \item Describe E-value and why extend to regression
  \item If you have raw data, could choose somewhere to dichotomize and use E-value for SMD or RR
  \item We provide E-value for cases where only standard regression info is reported
  \item Approach involves converting regression results to SMD with well-defined effect size (say why critical for E-value): show table with RR and lower and upper RR
\end{enumerate}
}

\item{ $\beta$-amyloid example \begin{enumerate}
\item .
\end{enumerate}
}

\item{ Caveats \begin{enumerate}
  \item What to do with preventative
  \item Multiple regression
  \item Be careful with interpretation: depends on $\Delta$
  \item Interpretation: E-value for a $\Delta$-unit increase in X and any dichotomization of Y
\end{enumerate}
}

\end{enumerate}



In general, we would recommend using $\Delta = 1$ in order to assess the E-value for the effect size corresponding directly to the regression coefficient, which represents a 1-unit contrast in $X$. However, if the units of $X$ are very fine-grained (e.g., if $X$ is blood pressure in mmHg), then a 1-unit increase may not be considered clinically meaningful, and a different choice of $\Delta$ may be used (e.g., $\Delta = 10$ to represent an increase in blood pressure of 10 mmHg), which is equivalent to rescaling the regression coefficient. It is imperative to report the choice of $\Delta$ if it is not taken to be 1, since it directly impacts the size and interpretation of the E-value analog. 


\section*{$\beta$-amyloid example}

```{r, echo = FALSE, message = FALSE}
library(EValue)

evalues.corr = function( r, SDx, delta, N = NA ) {
  d = (delta * r) / ( SDx * sqrt(1-r^2) )
  
  if( !is.na(N) ) se = delta / ( SDx * sqrt( (N-3) * (1 - r^2) ) )
  else se = NA 
  
  evalues.MD( est = d, se = se )
}
  
##### Pike 2007's Figures 3-4
# E-values for 1-SD increase in episodic memory
evalues.corr( r = -0.73, 1, 1, N = 31 + 33 + 32 )  # all subjects
evalues.corr( r = 0.04, 1, 1, N = 31 )  # AD
evalues.corr( r = -0.60, 1, 1, N = 33 )  # MCI
evalues.corr( r = -0.38, 1, 1, N = 32 )  # MCI  
```

\section*{Appendix}

Cover somewhere:

*Assumptions inherited from Chinn's conversion from d to log-OR: distrubtion of Y within each outcome group is logistic, but according to Chinn, this is basically the same as normality


\subsection{Converting univariable regression results to Cohen's $d$}

\begin{lemma}
Under the standard OLS framework, suppose that $Y = \beta_0 + \beta X + \epsilon$ with $X \amalg \epsilon$ and $E [ \epsilon ] = 0$. Then $ \sigma^2_{Y | X} = \left( 1 - r_{YX}^2 \right) \sigma^2_{Y}$. 

\begin{proof}

\begin{align*}
 \sigma^2_{Y} &= E [ \sigma^2_{Y | X} ] + Var \left( E [ Y | X ] \right) \\
  &= \sigma^2_{Y | X} + Var \left( \beta_0 + \beta X \right) \tag{homoskedasticity} \\
 &= \sigma^2_{Y | X} + \beta^2 \sigma^2_X \\
 &= \sigma^2_{Y | X} + r_{YX}^2 \sigma^2_Y \\
 \sigma^2_{Y | X} &= \left( 1 - r_{YX}^2 \right) \sigma^2_{Y}
 \end{align*}

\end{proof}
\end{lemma}



Suppose we estimate the conditional mean of an outcome $Y$ given a continuous exposure of interest, $X$, via ordinary least squares:
\begin{align*}
E \big[ Y \; \vert \; X \big] &= \beta_0 + \beta_X X \\
\end{align*}

where $\beta_0$ denotes the intercept and $\beta_X$ denotes the estimated coefficient of $X$. Suppose that the effect size of interest is the increase in $Y$ caused by a $\Delta$-unit increase in $X$. 

Assume that $(X,Y)$ are bivariate normal and consider the Cohen's $d$ associated with an increase of $\Delta$ units in $X$:

\begin{align*}
d &= \frac{ E [ Y \; \vert \; X=c+\Delta ] - E [ Y \; \vert \; X=c ] }{ \sigma_{Y|X} } \\
&= \frac{ \Delta \beta }{ \sigma_Y \sqrt{1 - \rho_{XY}^2} } \\
&= \frac{ \Delta \beta }{ \sigma_Y \sqrt{1 - \frac{ \beta^2 \sigma^2_X }{ \sigma^2_Y} } } \\
&= \frac{ \Delta \rho_{XY} }{ \sigma_X \sqrt{1 - \rho_{XY}^2} }
\end{align*}

where the denominator comes from a well-known property of the bivariate normal distribution. 

An approximate standard error can be derived using the delta method. Let $z_{fis} = XXX$ be the Fisher-transformed correlation, which is approximately normal with variance $\frac{1}{N-3}$. Define the transformation:

\begin{align*}
g(z_{fis}) &= d = \frac{ \Delta \text{tanh} \left(z_{fis}\right) }{ \sigma_X \sqrt{1 - \text{tanh}^2 \left(z_{fis}\right)} } \\
SE_{d} &\approx \sqrt{ \text{Var}(z_{fis}) } \left( g'\left( z_{fis} \right) \right) \\
&= \frac{1}{\sqrt{N-3}} \times \frac{\Delta}{\sigma_X \sqrt{ \text{sech}^2(z_{fis}) } } \\
&= \frac{\Delta}{ \sigma_X \sqrt{ (N-3) \left( 1 - \rho_{XY}^2 \right) } } \\
&= \frac{\Delta}{ \sigma_X \sqrt{ (N-3) \left( 1 - \beta^2 \frac{\sigma^2_X}{\sigma^2_Y} \right) } }
\end{align*}


\subsection{E-value for a univariable regression}

\begin{align*}
RR \approx \exp\left( 0.91 \times \frac{ \Delta \rho_{XY} }{ \sigma_X \sqrt{1 - \rho_{XY}^2} } \right)
\end{align*}

CI:
\begin{align*}
RR_{lb} &\approx \exp\left( 0.91 \times \frac{ \Delta \rho_{XY} }{ \sigma_X \sqrt{1 - \rho_{XY}^2} } - 1.78 \times SE_{d} \right) \\
&= RR_{ub} \approx \exp\left( 0.91 \times \frac{ \Delta \rho_{XY} }{ \sigma_X \sqrt{1 - \rho_{XY}^2} } + 1.78 \times SE_{d} \right)
\end{align*}

\subsection{Converting multivariable regression results to Cohen's $d$}

Extend the regression model in (EQUATION) to include arbitrary measured covariates $\mathbf{Z}$:
\begin{align*}
\widehat{E} \big[ Y \; \vert \; X, \mathbf{Z} \big] &= \widehat{\beta}_0 + \widehat{\beta}_X X + \mathbf{ \boldsymbol{\widehat{\beta} }_{Z}' Z}
\end{align*}

where $\boldsymbol{\widehat{\beta}}_{Z}$ denotes a vector of estimated coefficients for $\mathbf{Z}$.

\begin{align*}
R^2_{Y \sim X | Z} &= 1 - \frac{SSE_{full}}{SSE_{red}} \\
&= 1 - \frac{ \sigma^2_{Y|X,\mathbf{Z}} }{ \sigma^2_{Y|\mathbf{Z}} } \\
\sigma^2_{Y|X,\mathbf{Z}} &= \sigma^2_{Y|\mathbf{Z}} \left( 1 - R^2_{Y \sim X | Z} \right)
\end{align*}
DOES THIS USE MVN ASSUMPTION? FLESH OUT THIS STEP. SEEMS LIKE WE ONLY NEED NORMAL ERRORS. 


\begin{align*}
d &= \frac{ E [ Y \; \vert \; X=c+\Delta, \mathbf{Z} ] - E [ Y \; \vert \; X=c, \mathbf{Z} ] }{ \sigma_{Y|X, \mathbf{Z}} } \\
&= \frac{ \Delta \beta }{ \sigma_{Y|\mathbf{Z}} \sqrt{ 1 - R^2_{Y \sim X | Z} } } \\
& \ge \frac{ \Delta \beta }{ \sigma_{Y} \sqrt{ 1 - R^2_{Y \sim X | Z} } }
\end{align*}

Unlike in the univariable case, a simple relationship between $\beta$ and $R^2_{Y \sim X | Z}$ is not available with additional distributional assumptions, so both quantities are needed to approximate $d$. 

Note that you can use partial correlation or partial R^2 from regression table. 

Standard error:
Going to be hard because inference for $R^2_{YX | Z}$ won't be available. For an approximation, can use $Var\left( z^f_{YX | Z}\right) \approx Var\left( z^f_{YX}\right) = \frac{1}{N-3}$



* describe what to do for preventive: just set delta to be negative?
* say that, for univariable case, if SD of X isn't available, can set Delta = SD of X




\section*{References}
